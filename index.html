<!DOCTYPE html>
<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127622082-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-127622082-1');
    </script>

    <!-- Custom Content -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Messenger Data Analysis</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="./img/icon.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />   
</head>

<body>
    <div id="header">
        <div class="block header-bg-img">
            <div class="container text-center">
                <div class="graph-logo-bottom">
                    <div class="graph-bar-1"></div>
                    <div class="graph-bar-2"></div>
                    <div class="graph-bar-3"></div>
                    <div class="graph-bar-4"></div>
                </div>
                <h1 class="header-title-img display-4 font-weight-bold mt-4">Messenger Data Analysis</h1>
                <!-- <img class="header-title-img img-fluid" src="./img/TestHeader.png" alt=""> -->
            </div>
        </div>
        <div class="block header-intro text-light">
            <div class="container text-center">
                <h3>Welcome to Messenger Data Analysis</h3>
                <h4 class="h4-c">Take a dive into your Facebook messages and discover your most used words & emojis, message frequency, and more!</h3>
            </div>
        </div>
        <div class="triangle-down-mid text-center"></div>
        <div class="triangle-down-mid-center text-center"></div>
    </div>

    <div id="marketing-cards" class="container">
        <div class="card-deck">
            <div class="card text-center">
                <div class="card-body">
                    <img src="./img/messenger-logo-colour.png" class="card-img-top mda-card-img" alt="...">
                    <h5 class="card-title">Works with Facebook Messenger</h5>
                    <p class="card-text">Download your data from Facebook and you can analyse both personal and group conversations!</p>
                </div>
            </div>
            <div class="card text-center">
                <div class="card-body">
                    <img src="./img/no-network.png" class="card-img-top mda-card-img" alt="...">
                    <h5 class="card-title">Runs completely offline</h5>
                    <p class="card-text">Your data is not uploaded to any server - analysis is done by your computer, locally in your browser. <a href="#">Learn more</a>.</p>
                </div>
            </div>
            <div class="card text-center">
                <div class="card-body">
                    <img src="./img/bar-chart.png" class="card-img-top mda-card-img" alt="...">
                    <h5 class="card-title">Visually represent your data</h5>
                    <p class="card-text">Get beautiful charts of your data, and customise them to get a better look at what interests you.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="instructions" class="container">
        <div class="mda-spacer"></div>
        <div class="card w-75 m-auto start-analysis-box">
            <div class="card-body text">
                <h3 class="text-center">Get Started Now!</h3>
                <div class="w-75 mt-4 mx-auto">
                    <p><strong>Step 0.</strong> Analyse a sample file to get a taste of what it can do! <a href="">Click here</a></p>
                    <p><strong>Step 1.</strong> Download your Messenger data from Facebook. Don't know how? <a href="" data-toggle="modal" data-target="#guide-modal">Click here for a guide</a>!</p>
                    <p><strong>Step 2.</strong> Browse for your file, then hit "Start" to begin the analysis. It's that easy!</p>
                </div>
            </div>
            <div class="custom-file w-75 m-auto">
                <input id="open-file" type="file" class="custom-file-input" accept=".json" onchange="updateStatus(); changeFileSelectLabel()">
                <label id="open-file-label" class="custom-file-label text-center" for="customFile" >Choose file (.json format only)</label>
            </div>
            <input id="submit-file" type="submit" class="btn btn-success w-25 mx-auto my-3" disabled value="Start">

            <div id="status-display" class="text-center my-1">
                <div id="status-googlechart-load">
                    <div class="spinner-grow text-danger" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p>Google Charts service is loading. Please wait.</p>
                </div>

                <div id="status-analysing" hidden>
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p>Analysing</p>
                </div>

                <div id="status-complete" hidden>
                    <div class="mda-tick-height">
                        <div class="mda-tick" role="status"></div>
                    </div>
                    <p>Complete!</p>
                </div>
            </div>
        </div>
    </div>

    <!--  Modal - Messenger Data Download Guide -->
    <div class="modal fade" id="guide-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Downloading Your Facebook Messenger Data</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Go to Facebook and click on the small down arrow in the top right, near the notification icon. Go into settings.</p>

                    <div class="text-center">
                        <img class="w-100 my-3 border border-primary" src="./img//facebook-download-guide/guide-image-1.png" alt="">
                    </div>

                    <p>On the left panel, go into "Your Facebook Information" and click "Download Your Information".</p>

                    <div class="text-center ">
                        <img class="w-100 my-3 border border-primary" src="./img//facebook-download-guide/guide-image-2.png" alt="">
                    </div>

                    <p>On this page, make sure you have date range as "All of my data" and the format as "JSON". If you download your data as HTML, the analysis will not work. For media quality, low is recommended to reduce file size.</p>
                    <p>For Messenger Analysis, you only need to select "Messages", but you can download everything if you wish (the file can get quite big if you download it all).</p>

                    <div class="text-center">
                        <img class="w-100 my-3 border border-primary" src="./img//facebook-download-guide/guide-image-3.png" alt="">
                    </div>

                    <p>Facebook will take a few minutes to process your information before you can download the file - you will get a notification when it is ready.</p>
                    <p>Once it has downloaded, extract the files. On Windows, right click and select "Extract All". On a Mac just double click the file and it will extract to the same folder it is in.</p>
                    <p>Now you are ready to start the analysis!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="section2" class="container">
        <p style='overflow:hidden;page-break-before:always;'></p>

        <div class="mda-spacer"></div>

        <div class="">
            <h3 class="display-4 mb-2">Conversation Information</h3>
            <div id="conversation-info">
                
            </div>
        </div>

        <div class="mda-spacer"></div>

        <!-- Start Charts -->
        <div id="chart-container" class="">
            <div class="d-flex flex-row">
                <h4>Messages Sent</h4>
                <h4 class="ml-50pc">Words Sent</h4>
            </div>
            <div class="d-flex flex-row">
                <div id="chart-MessagesSentCount" class="mda-chart"></div>
                <div id="chart-WordsSentCount" class="mda-chart ml-auto"></div>
            </div>
        </div>
        <!-- End Charts -->

    </div>

    <div id="conversationInformation" class="text-center" hidden>
        <h3 id="conversationTitle" class="display-4">Conversation Information</h3>
        <br>
        <p id="info"></p>

        <hr class="my-3 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">

        <div class="d-inline-block mt-3 mb-3">
            <div id="pieChartContainer" class="d-flex">
                <div id="messageSentInfo-chart"></div>
                <div id="wordsSentInfo-chart"></div>
            </div>
        </div>

        <table id="participantWordInfoTable" class="table-sm table-striped table-bordered text-center" style="margin: auto!important;">
            <thead class="bg-primary text-light">
                <th class="px-2">Name</th>
                <th class="px-2">Messages Sent</th>
                <th class="px-2">Words Sent</th>
                <th class="px-2">Average Words/Message</th>
            </thead>
            <tbody id="participantWordInfoBody">
            </tbody>
        </table>

        <br>

        <table id="messageTypeTable" class="table-sm table-striped table-bordered text-center" style="margin: auto!important;">
            <thead id="typesHeaderRow" class="bg-primary text-light">
                <th class="px-2">Name</th>
                <th class="px-2">Text Messages</th>
                <th class="px-2">Photos</th>
                <th class="px-2">Videos</th>
                <th class="px-2">Stickers</th>
                <th class="px-2">GIFs</th>
                <th class="px-2">Files</th>
                <th class="px-2">Shared Links</th>
                <th class="px-2">Audio Files</th>
                <th class="px-2">Plans</th>
            </thead>
            <tbody id="messageTypesInfoTable">
            </tbody>
        </table>

        <p style='overflow:hidden;page-break-before:always;'></p>
        
        <div id="chartContainer" class="text-center" style="display: inline-block;">

            <hr class="my-3 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="day-chart2"></div>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="month-chart"></div>

            <p style='overflow:hidden;page-break-before:always;'></p>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="year-chart"></div>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="time-chart"></div>

            <p style='overflow:hidden;page-break-before:always;'></p>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="historical-chart"></div>
            <div>
                <strong>Horizontal Axis  Range</strong>
                <br>
                Minimum: <input id="histMin" type="date" name="quantity" value="2013-10-14" class="form-control w-25 d-inline-block" oninput="histChangeXAxisBounds()">
                Maximum: <input id="histMax" type="date" name="quantity" value="2018-10-14" class="form-control w-25 d-inline-block" oninput="histChangeXAxisBounds()">
                <button type="button" id="resetHistRange" class="btn btn-primary" onclick="resetHistRange();">Reset to default</button>
            </div>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="messageLength-chart"></div>
            <div>
                <strong>Horizontal Axis Range</strong>
                <br>
                Minimum: <input id="msgLengthMin" type="number" name="quantity" value="0" class="form-control w-25 d-inline-block" oninput="msgLengthChangeXAxisBounds()">
                Maximum: <input id="msgLengthMax" type="number" name="quantity" value="1" class="form-control w-25 d-inline-block" oninput="msgLengthChangeXAxisBounds()">
                <button type="button" id="resetMsgLengthRange" class="btn btn-primary" onclick="resetMsgLengthRange();">Reset to default</button>
                <br>
                <small>To get a clearer view for message lengths that are less frequent, try setting graph display to '100% stacked'</small>
                <br>
                <p id="messageLengthInfo"></p>
            </div>

            <p style='overflow:hidden;page-break-before:always;'></p>

            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <div class="mda-chart" id="word-chart"></div>
            <p>Want to see more interesting word frequency results? Try <a href="#wordSearchRange">setting limits on the minimum and maximum word length</a>.</p>
            <hr class="my-4 w-75" style="border-width: 7px; border-color:#4285F4; background-color:#4285F4;">
            <p>Unfortunately due to limitations in the Google Charts API, I cannot put the emoji images in the labels of the graph. What you see below is the best compromise I could come up with.</p>

            <div class="mda-chart" id="emoji-chart"></div>
            <br>
            
            <p style='overflow:hidden;page-break-before:always;'></p>

            <table id="emojiTable" class="table-sm table-striped table-bordered text-center" style="margin: auto!important;">
                <thead class="bg-primary text-light">
                    <tr id="emojiTableHead">
                        <th class="px-2">Rank</th>
                        <th class="px-2">Emoji</th>
                    </tr>
                </thead>
                <tbody id="emojiTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <footer class="container d-block">
        Created by Eric M 2018 || <a href="https://github.com/EricEzaM/EricEzaM.github.io">GitHub Source</a> || <a href="mailto:messengerdata.site@gmail.com">messengerdata.site@gmail.com</a> || Emoji icons provided free by <a href="https://www.emojione.com/">EmojiOne</a>
    </footer>
</body>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/google-palette@1.1.0/palette.js" integrity="sha256-5f158MWiiHKxtoGF9P+WFLMLh3bMthtMx58ayBvTF38=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript" src="emojiSplitter.min.js"></script>
<script type="text/javascript" src="main.js"></script>

</html>
